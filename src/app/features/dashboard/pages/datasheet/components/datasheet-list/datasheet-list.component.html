<div class="w-full min-h-full">

    <div class="px-6 mt-6">

        <!-- Barra de acciones superior -->
        <div class="flex items-center justify-between mb-2 px-4 sm:px-6">
            <div class="flex items-center gap-3">
                <div class="h-8 w-1 bg-emerald-500 rounded-full"></div>
                <div>
                    <h2
                        class="text-lg font-semibold text-gray-900 dark:text-white">
                        Fichas técnicas ambientales</h2>
                </div>
            </div>
            @if(projectTypes().length > 0) {
                <button
                mat-flat-button
                color="primary"
                (click)="onAddDatasheet()"
                class="bg-gradient-to-r! from-emerald-500! to-emerald-600! dark:from-emerald-400! text-white! dark:text-neutral-950! shadow-lg font-medium"
                aria-label="Agregar nueva ficha técnica">
                <mat-icon class="mr-2">add_circle</mat-icon>
                <span>Agregar</span>
            </button>
            }
        </div>

        <!-- Filtros básicos -->
        <app-datasheet-basic-filters (filtersChanged)="onFiltersChanged()" />

        <!-- Filtros avanzados -->
        <app-datasheet-advanced-filters (filtersChanged)="onFiltersChanged()" />
    </div>

    <!-- Contenido principal -->
    <div class="px-6 py-2">
        <!-- Loading State -->
        @if (loading()) {
        <div class="flex items-center justify-center py-12">
            <div
                class="animate-spin rounded-full h-6 w-6 border-2 border-emerald-500 border-t-transparent"></div>
            <span
                class="ml-2 text-base text-gray-600 dark:text-gray-300">Cargando
                fichas técnicas...</span>
        </div>
        } @else {<!-- Cards Container -->
        <div class="space-y-1">
            <div class="px-10">
                <app-paginator
                    [total]="total()"
                    [page]="currentPage()"
                    [pageSize]="currentPageSize()"
                    [pageSizeOptions]="[5, 10, 25, 50, 100]"
                    [disabled]="loading()"
                    (pageChanged)="onPageChange($event)"
                    class="block">
                </app-paginator>
            </div>
            @for(ficha of datasheets(); track ficha.id) {
            <app-datasheet-card [datasheet]="ficha" />
            } @empty {
            <div class="text-center py-16">
                <div
                    class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800 mb-4">
                    <svg class="w-6 h-6 text-gray-400" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            stroke-width="1.5"
                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div> <h3 class="text-lg text-gray-900 dark:text-white mb-1">No
                    hay
                    fichas técnicas</h3>
                <p class="text-base text-gray-500 dark:text-gray-400">No se
                    encontraron fichas técnicas disponibles en este momento.</p>
            </div>
            }
            <div class="px-10">
                <app-paginator
                    [total]="total()"
                    [page]="currentPage()"
                    [pageSize]="currentPageSize()"
                    [pageSizeOptions]="[5, 10, 25, 50, 100]"
                    [disabled]="loading()"
                    (pageChanged)="onPageChange($event)"
                    class="block">
                </app-paginator>
            </div>
        </div>
        }
    </div>
</div>
