<div class="w-full">
  <!-- Days selector grid -->
  <div class="grid grid-cols-7 gap-2 w-full max-w-md mx-auto sm:max-w-none sm:flex sm:flex-wrap sm:justify-center md:justify-start">
    @for(day of dayOfWeek; track day.value) {
      <button
        type="button"
        [matTooltip]="day.description"
        [ngClass]="{
          'bg-emerald-600 text-white shadow-md': isSelected(day.value),
          'bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 shadow-sm': !isSelected(day.value),
          'hover:bg-emerald-500 hover:text-white transform hover:scale-105 transition-all duration-200': !disabled && !isSelected(day.value),
          'hover:bg-emerald-700 hover:shadow-lg transition-all duration-200': !disabled && isSelected(day.value),
          'opacity-50 cursor-not-allowed': disabled
        }"
        class="w-9 h-9 flex items-center justify-center rounded-full focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-1 font-medium text-sm transition-all duration-200"
        (click)="toggleDay(day.value)"
        [disabled]="disabled"
        [attr.aria-pressed]="isSelected(day.value)"
        [attr.aria-label]="day.description">
        <span class="select-none">{{ day.label }}</span>
      </button>
    }
  </div>

  <!-- Error message -->
  @if(!hasValidSelection() && touched) {
    <div class="text-red-500 text-xs mt-3 flex items-center gap-1 justify-center sm:justify-start">
      <mat-icon class="!text-base">error</mat-icon>
      <span>Selecciona al menos un día</span>
    </div>
  }

  <!-- Selected days summary -->
  @if(hasValidSelection()) {
    <div class="mt-3 text-xs text-emerald-700 dark:text-emerald-300 text-center sm:text-left">
      <span class="font-medium">Seleccionados: {{ getSelectedDaysInfo().descriptions.join(', ') }}</span>
    </div>
  }

  <!-- Quick selection chips -->
  <div class="flex flex-wrap gap-2 mt-4 justify-center sm:justify-start">
    <button
      type="button"
      class="text-xs px-3 py-1.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium"
      (click)="selectWeekdays()"
      [disabled]="disabled">
      Días laborales
    </button>
    <button
      type="button"
      class="text-xs px-3 py-1.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium"
      (click)="selectWeekends()"
      [disabled]="disabled">
      Fines de semana
    </button>
    <button
      type="button"
      class="text-xs px-3 py-1.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium"
      (click)="selectAllDays()"
      [disabled]="disabled">
      Todos los días
    </button>
  </div>
</div>

